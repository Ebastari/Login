<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Montana AI – Login</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
:root {
  --brand:#27e38a;
  --brand-dark:#0b6a4a;
  --text:#eaf7f0;
  --primary-green:#2f6e41;
  --dark-green:#215333;
  --whatsapp-green:#25D366;
  --whatsapp-dark:#128C7E;
  --card-background:#ffffff;
}

/* === GLOBAL === */
* { box-sizing:border-box; margin:0; padding:0; }
html,body {
  height:100%;
  font-family:'Roboto',sans-serif;
  background:#000;
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:center;
}

/* === LOADING SCREEN === */
#loadingScreen {
  position:fixed;
  inset:0;
  background:#000;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  color:var(--text);
  z-index:200;
  transition:opacity 1s ease;
}
#loadingScreen.fade-out { opacity:0; pointer-events:none; }
.welcome {
  font-size:clamp(26px,6vw,46px);
  font-weight:800;
  color:var(--brand);
  text-shadow:0 0 15px rgba(39,227,138,0.6);
  margin-bottom:25px;
}
.bar {
  width:80%; max-width:480px;
  height:14px; border-radius:999px;
  background:rgba(39,227,138,.15);
  box-shadow:inset 0 0 0 1px rgba(39,227,138,.25);
  overflow:hidden;
}
.fill {
  height:100%; width:0%;
  background:linear-gradient(90deg,var(--brand-dark),var(--brand));
  border-radius:inherit;
  box-shadow:0 0 16px rgba(39,227,138,.35);
  transition:width .08s linear;
}
.percent {margin-top:8px;font-weight:700;font-size:clamp(18px,4vw,26px);}
.hint {font-size:0.9em;opacity:0.9;margin-top:5px;}

/* === VIDEO SPLASH === */
#videoSplash {
  position:fixed;
  inset:0;
  z-index:100;
  background:black;
  display:none;
}
#videoSplash video {
  width:100%;
  height:100%;
  object-fit:contain;
  background:black;
}

/* === LOGIN === */
.login-container {
  position:relative;
  z-index:5;
  background:rgba(255,255,255,0.9);
  backdrop-filter:blur(6px);
  padding:30px;
  border-radius:25px;
  box-shadow:0 15px 35px rgba(0,0,0,0.3);
  max-width:380px;
  width:90%;
  text-align:center;
  opacity:0;
  transform:translateY(50px);
  transition:opacity 1.2s ease, transform 1.2s ease;
}
.login-container.show {
  opacity:1;
  transform:translateY(0);
}
h2 {color:var(--dark-green);font-weight:700;margin-bottom:5px;}
p.subtitle {color:#777;margin-bottom:25px;font-size:0.9em;}
.input-group {margin-bottom:20px;text-align:left;}
.input-group label {font-weight:500;color:var(--dark-green);font-size:0.85em;margin-bottom:6px;display:block;}
input {
  width:100%;
  padding:13px;
  border:2px solid #eee;
  border-radius:12px;
  font-size:1em;
  transition:border-color 0.3s ease, box-shadow 0.3s ease;
}
input:focus {
  border-color:var(--primary-green);
  box-shadow:0 0 0 4px rgba(47,110,65,0.2);
  outline:none;
}
button.whatsapp-btn {
  display:flex;justify-content:center;align-items:center;
  width:100%;padding:14px;
  background:linear-gradient(to right,var(--whatsapp-green),var(--whatsapp-dark));
  color:white;border:none;border-radius:12px;
  font-weight:600;font-size:1.05em;cursor:pointer;
  box-shadow:0 8px 20px rgba(37,211,102,0.4);
  transition:transform 0.2s ease, box-shadow 0.2s ease;
}
button.whatsapp-btn:hover {transform:translateY(-3px);}
.hidden {display:none !important;}
.info {
  font-size:0.9em;color:var(--dark-green);
  margin-top:20px;text-align:center;
  padding:10px;border:1px dashed var(--primary-green);
  border-radius:10px;background-color:#f0fdf0;
}

@media(max-width:600px){
  .login-container{width:90%;padding:25px;}
}
</style>
</head>
<body>

<!-- === LOADING === -->
<div id="loadingScreen">
  <div class="welcome">Welcome to Montana AI</div>
  <div class="bar"><div class="fill" id="fill"></div></div>
  <div class="percent" id="percent">0%</div>
  <div class="hint" id="hint">Menginisialisasi sistem AI...</div>
</div>

<!-- === VIDEO SPLASH === -->
<div id="videoSplash">
  <video id="introVideo" autoplay muted playsinline webkit-playsinline preload="auto">
    <source src="Video%20Project%201.mp4" type="video/mp4">
    Browser Anda tidak mendukung video HTML5.
  </video>
</div>

<!-- === LOGIN === -->
<div class="login-container" id="loginBox">
  <h2>Montana AI</h2>
  <p class="subtitle">Artificial Intelligence for Smart Land Reclamation</p>

  <form id="loginForm">
    <div class="input-group">
      <label for="username">Peran (admin atau guest)</label>
      <input type="text" id="username" name="username" placeholder="Ketik: admin atau guest" required autocomplete="off" />
    </div>

    <div id="passwordDiv" class="input-group">
      <label for="password">Kata Sandi (Hanya untuk Admin)</label>
      <input type="password" id="password" name="password" placeholder="Masukkan kata sandi" autocomplete="off" />
    </div>

    <div id="phoneDiv" class="input-group hidden">
      <label for="phone">Nomor WhatsApp (Contoh: 6281234567890)</label>
      <input type="text" id="phone" name="phone" placeholder="Masukkan nomor WA aktif" inputmode="numeric" autocomplete="off" />
    </div>

    <div id="otpDiv" class="input-group hidden">
      <label for="otp">Masukkan Kode OTP</label>
      <input type="number" id="otp" name="otp" placeholder="Kode 6 digit" />
    </div>

    <button type="submit" id="submitBtn" class="whatsapp-btn">
      <i class="fas fa-sign-in-alt"></i> Masuk
    </button>
  </form>
  <div class="info" id="infoMsg"></div>
</div>

<script>
/* === LOADING === */
const fillEl=document.getElementById('fill');
const percentEl=document.getElementById('percent');
const hintEl=document.getElementById('hint');
const loadingScreen=document.getElementById('loadingScreen');
const videoSplash=document.getElementById('videoSplash');
const introVideo=document.getElementById('introVideo');
const loginBox=document.getElementById('loginBox');
const DURATION_MS=4000;
const start=performance.now();

function animate(now){
  const elapsed=now-start;
  let pct=Math.min(100,Math.round((elapsed/DURATION_MS)*100));
  fillEl.style.width=pct+'%';
  percentEl.textContent=pct+'%';
  hintEl.textContent=`Menyiapkan modul kecerdasan buatan… (${pct}%)...`;

  if(pct<100){requestAnimationFrame(animate);}
  else{
    hintEl.textContent='Hai, Forester Montana AI siap digunakan...';
    setTimeout(()=>{
      loadingScreen.classList.add('fade-out');
      setTimeout(()=>{
        loadingScreen.style.display='none';
        videoSplash.style.display='block';
        introVideo.play();
      },800);
    },600);
  }
}
requestAnimationFrame(animate);

/* === Setelah video selesai, tampilkan login === */
introVideo.addEventListener('ended',()=>{
  videoSplash.style.transition='opacity 1.5s ease';
  videoSplash.style.opacity='0';
  setTimeout(()=>{
    videoSplash.style.display='none';
    loginBox.classList.add('show');
  },1200);
});

/* === LOGIN LOGIC === */
const form=document.getElementById('loginForm');
const usernameInput=document.getElementById('username');
const passwordDiv=document.getElementById('passwordDiv');
const phoneDiv=document.getElementById('phoneDiv');
const otpDiv=document.getElementById('otpDiv');
const infoMsg=document.getElementById('infoMsg');
const submitBtn=document.getElementById('submitBtn');
let generatedOTP=null;let guestStage=0;

usernameInput.addEventListener('input',()=>{
  const role=usernameInput.value.trim().toLowerCase();
  infoMsg.textContent='';otpDiv.classList.add('hidden');
  if(role==='guest'){
    passwordDiv.classList.add('hidden');
    phoneDiv.classList.remove('hidden');
    submitBtn.innerHTML='<i class="fab fa-whatsapp"></i> Dapatkan OTP';
  }else if(role==='admin'){
    passwordDiv.classList.remove('hidden');
    phoneDiv.classList.add('hidden');
    submitBtn.innerHTML='<i class="fas fa-sign-in-alt"></i> Masuk sebagai Admin';
  }else{
    passwordDiv.classList.remove('hidden');
    phoneDiv.classList.add('hidden');
    submitBtn.innerHTML='<i class="fas fa-sign-in-alt"></i> Masuk';
  }
});

form.addEventListener('submit',(e)=>{
  e.preventDefault();
  const role=usernameInput.value.trim().toLowerCase();
  if(role==='admin'){
    const pass=document.getElementById('password').value.trim().toLowerCase();
    if(pass==='kalimantan selatan'){
      alert('✅ Selamat datang, Admin!');
      window.location.href='https://ebastari.github.io/homeadmin/HOME%20-%20admin.html';
    }else alert('❌ Password salah!');
    return;
  }
  if(role==='guest'){
    let phone=form.phone.value.trim().replace(/\s+/g,'').replace(/^\+/, '');
    if(phone.startsWith('0')) phone='62'+phone.substring(1);
    if(!/^62\d{8,13}$/.test(phone)){
      alert('Masukkan nomor WhatsApp valid.');
      return;
    }
    if(guestStage===0){
      generatedOTP=Math.floor(100000+Math.random()*900000);
      guestStage=1;
      infoMsg.innerHTML=`✅ OTP Dibuat! Klik tombol di bawah untuk kirim kode <b>${generatedOTP}</b> ke WhatsApp Anda.`;
      otpDiv.classList.remove('hidden');
      submitBtn.innerHTML='<i class="fab fa-whatsapp"></i> Kirim OTP & Verifikasi';
      const waMessage=`Kode OTP Montana AI Anda: ${generatedOTP}`;
      const waUrl=`https://wa.me/${phone}?text=${encodeURIComponent(waMessage)}`;
      window.open(waUrl,'_blank');
      return;
    }
    if(guestStage===1){
      const inputOtp=form.otp.value.trim();
      if(inputOtp===generatedOTP.toString()){
        alert('✅ Login Guest berhasil!');
        infoMsg.textContent='Mengalihkan ke dashboard...';
        guestStage=0;generatedOTP=null;
        setTimeout(()=>window.location.href='https://ebastari.github.io/montanaAIguest/HOME%20-%20Guest.html',1500);
      }else alert('❌ Kode OTP salah.');
    }
  } else alert('⚠️ Hanya "admin" atau "guest" yang diperbolehkan.');
});
</script>
</body>
</html>



